"use strict";(self["webpackChunkmoire"]=self["webpackChunkmoire"]||[]).push([[61],{8061:function(t,e,s){s.r(e),s.d(e,{default:function(){return x}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[t.isLoading?s("Loader"):t._e(),s("div",[s("div",{staticClass:"content__top"},[s("Breadcrumbs",{attrs:{crumbs:t.crumbs},on:{selectedCrumb:function(e){return t.goToPage(e)}}})],1),s("section",{staticClass:"item"},[s("div",{staticClass:"item__pics pics"},[s("div",{staticClass:"pics__wrapper"},[s("img",{attrs:{width:"570",height:"570",src:t.selectedImageColor.url?t.selectedImageColor.url:"./img/no_image.jpg",alt:t.product.title}})]),s("ul",{staticClass:"pics__list"},t._l(t.filterColorImage,(function(e){return s("li",{staticClass:"pics__item"},[s("a",{staticClass:"pics__link",class:{"pics__link--current":t.selectedImageColor.url==e.url},on:{click:function(s){s.preventDefault(),t.selectedImageColor=e}}},[s("img",{staticStyle:{height:"141px"},attrs:{src:e.url||"./img/no_image.jpg",alt:t.product.title}})])])})),0)]),s("div",{staticClass:"item__info"},[s("span",{staticClass:"item__code"},[t._v("Артикул: "+t._s(t.product.id))]),s("h2",{staticClass:"item__title"},[t._v(t._s(t.product.title))]),s("div",{staticClass:"item__form"},[s("form",{staticClass:"form",on:{submit:function(e){return e.preventDefault(),t.addToBasket.apply(null,arguments)}}},[s("div",{staticClass:"item__row item__row--center"},[s("ProductCount",{attrs:{"product-count":t.productCount},on:{"update:productCount":function(e){t.productCount=e},"update:product-count":function(e){t.productCount=e},"catch-error":function(e){t.errorCounter=e}}}),t.errorCounter.errors.length?s("span",{staticClass:"invalid-counter"},[t._v(t._s(t.errorCounter.errors[0]))]):s("b",{staticClass:"item__price"},[t._v(" "+t._s(t._f("numberFormat")(t.productTotalPrice))+" ₽ ")])],1),s("div",{staticClass:"item__row"},[s("fieldset",{staticClass:"form__block"},[s("legend",{staticClass:"form__legend"},[t._v("Цвет")]),s("ul",{staticClass:"colors colors--black"},t._l(t.filterColorImage,(function(e){return s("li",{key:e.id,staticClass:"colors__item"},[s("ProductColor",{attrs:{color:e,"selected-color":t.selectedImageColor},on:{"update:selectedColor":function(e){t.selectedImageColor=e},"update:selected-color":function(e){t.selectedImageColor=e}},model:{value:t.selectedImageColor,callback:function(e){t.selectedImageColor=e},expression:"selectedImageColor"}})],1)})),0)]),s("fieldset",{staticClass:"form__block"},[s("legend",{staticClass:"form__legend"},[t._v("Размер")]),s("label",{staticClass:"form__label form__label--small form__label--select"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.selectedSize,expression:"selectedSize"}],staticClass:"form__select",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.selectedSize=e.target.multiple?s:s[0]}}},t._l(t.product.sizes,(function(e){return s("option",{key:e.id,domProps:{value:e.id}},[t._v(" "+t._s(e.title)+" ")])})),0)])])]),t.productAddedError?s("RequestError",{attrs:{"btn-text":"Сообщить о поступлении",error:t.productAddedError},on:{load:t.openModal}}):t._e(),t.isProductAdded?s("div",{staticClass:"invalid invalid-size"},[t._v("Товар добавлен в корзину ")]):t._e(),s("button",{staticClass:"item__button button button--primery",attrs:{type:"submit"}},[t._v(" В корзину ")])],1)])]),s("ProductInfoTabs",{attrs:{"product-info":t.product}})],1)]),t.isModalOpen?s("Modal",{on:{close:function(e){return t.closeModal(e)}}},[s("ValidationObserver",{scopedSlots:t._u([{key:"default",fn:function(e){var r=e.invalid,o=e.validate,i=e.dirty;return[t.isReceipt?s("div",[t._v(" Спасибо за заявку! Как только товар поступит на склад мы сразу сообщим вам! ")]):s("div",[s("span",{staticClass:"connect__text"},[t._v(" Выберите предпочтительный способ связи ")]),s("ul",{staticClass:"check-list"},t._l(t.connectList,(function(e){return s("li",{key:e.id,staticClass:"check-list__item"},[s("label",{staticClass:"check-list__label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.selectedConnection,expression:"selectedConnection"}],staticClass:"check-list__check sr-only",attrs:{type:"checkbox"},domProps:{value:e,checked:Array.isArray(t.selectedConnection)?t._i(t.selectedConnection,e)>-1:t.selectedConnection},on:{change:function(s){var r=t.selectedConnection,o=s.target,i=!!o.checked;if(Array.isArray(r)){var a=e,c=t._i(r,a);o.checked?c<0&&(t.selectedConnection=r.concat([a])):c>-1&&(t.selectedConnection=r.slice(0,c).concat(r.slice(c+1)))}else t.selectedConnection=i}}}),s("span",{staticClass:"check-list__desc"},[t._v(" "+t._s(e.name)+" ")])]),s("BaseFieldText",{directives:[{name:"mask",rawName:"v-mask",value:2==e.id?"+7 (###)-###-##-##":"",expression:"connect.id == 2 ? '+7 (###)-###-##-##' : ''"}],attrs:{rules:e.rules,placeholder:e.placeholder,disabled:!t.selectedConnection.includes(e)},model:{value:e.value,callback:function(s){t.$set(e,"value",s)},expression:"connect.value"}})],1)})),0),s("button",{staticClass:"cart__button button button--primery",attrs:{type:"button",disabled:r||!t.selectedConnection.length||!i},on:{click:function(e){e.preventDefault(),o().then(t.reportReceipt)}}},[t._v(" Сообщить о поступлении ")])])]}}],null,!1,1280231449)})],1):t._e()],1)},o=[],i=s(2049),a=s(3736),c=s(2825),l=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"item__desc"},[s("ul",{staticClass:"tabs"},t._l(t.productInfoTabsList,(function(e){return s("li",{key:e.id,staticClass:"tabs__item"},[s("a",{staticClass:"tabs__link",class:{"tabs__link--current":t.currentTab==e},on:{click:function(s){s.preventDefault(),t.currentTab=e}}},[t._v(" "+t._s(e.title)+" ")])])})),0),1==t.currentTab.id?s("div",{staticClass:"item__content"},[s("h3",[t._v("Состав:")]),t._l(t.productInfo.materials,(function(e,r){return s("span",[e.title?s("span",[t._v(t._s(e.title))]):t._e(),r+1<t.productInfo.materials.length?s("span",[t._v(", ")]):t._e()])})),s("h3",[t._v("Коллекция:")]),t._l(t.productInfo.seasons,(function(e,r){return s("span",[e.title?s("span",[t._v(t._s(e.title))]):t._e(),r+1<t.productInfo.seasons.length?s("span",[t._v(", ")]):t._e()])})),s("h3",[t._v("Категория:")]),t.categoryTitle?s("span",[t._v(" "+t._s(t.categoryTitle)+" ")]):t._e()],2):t._e(),2==t.currentTab.id?s("div",{staticClass:"item__content"},[s("h3",[t._v("Доставка:")]),t._m(0),s("h3",[t._v("Возврат:")]),t._m(1)]):t._e()])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"delivery"},[s("span",[s("span",[t._v("Самовывоз - бесплатно")]),s("br"),s("span",[t._v("Курьером - расситывается при оформлении заказа")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[t._v(" Любой возврат должен быть осуществлен в течение Возвраты в магазине БЕСПЛАТНО."),s("br"),t._v(" Вы можете вернуть товары в любой магазин. Магазин должен быть расположен в стране, в которой Вы осуществили покупку. БЕСПЛАТНЫЙ возврат в Пункт выдачи заказов."),s("br"),t._v(" Для того чтобы вернуть товар в одном из наших Пунктов выдачи заказов, позвоните по телефону 8 800 600 90 09"),s("br")])}],d=s(1836),u={props:["productInfo"],data(){return{currentTab:"",productInfoTabsList:d.JK}},mounted(){this.currentTab=this.productInfoTabsList[0]},computed:{categoryTitle(){return this.productInfo.category?this.productInfo.category.title:""}}},_=u,p=s(1001),m=(0,p.Z)(_,l,n,!1,null,"0818b353",null),v=m.exports,C=s(5494),h=s(2074),f=s(9747),g=s(8030),b=s(3246),k=s(5036),I=s(5708),y=s(3822),T=s(9414),P={inject:["$validator"],name:"ProductPage",components:{ProductCount:c.Z,ProductInfoTabs:v,Breadcrumbs:h.Z,ProductColor:C.Z,Loader:f.Z,RequestError:g.Z,Modal:b.Z,BaseFieldText:k.Z,ValidationObserver:I._j},directives:{mask:{bind(t,e,s,r){e.value&&(0,T.mask)(t,e,s,r)}}},data(){return{product:{},filterColorImage:[],selectedImageColor:"",selectedSize:"",productCount:1,isLoading:!1,errorCounter:{errors:[]},isProductAdded:!1,productAddedError:"",isModalOpen:!1,connectList:d.N,selectedConnection:[],isReceipt:!1}},mounted(){this.getProductDetail()},computed:{...(0,y.Se)(["requestErrors"]),productTotalPrice(){return this.product.price*this.productCount},crumbs(){return[this.product?.category?.title,this.product.title]}},methods:{...(0,y.nv)(["addProductToBasket"]),goToPage(){this.$router.push({name:"MainPage",query:{categoryId:this.product.category.id}})},addToBasket(){this.isLoading=!0,this.addProductToBasket({productId:this.product.id,colorId:this.selectedImageColor.id,sizeId:this.selectedSize,quantity:this.productCount}).then((()=>{this.isLoading=!1,this.isProductAdded=!0,this.productAddedError=!1})).catch((t=>{this.isProductAdded=!1,this.isLoading=!1,t.response.data.error.request.sizeId?this.productAddedError="К сожалению, данного размера нет в наличие":this.productAddedError="При добавлении товара в корзину произошла ошибка. Пожалуйста, обновите страницу "}))},getProductDetail(){let{id:t}=this.$route.params;this.isLoading=!0,i.Z.get(`products/${t}`).then((t=>{this.product=t.data,this.filterColorImage=t.data.colors.map((t=>({id:t.color.id,code:t.color.code,url:t.gallery?t.gallery.map((t=>t.file.url)).join():""}))),this.selectedImageColor=this.filterColorImage[0],this.selectedSize=t.data?.sizes?t.data?.sizes[0].id:"",this.isLoading=!1})).catch((t=>{"404"==t.response.data.error.code?this.$router.push({name:"404"}):this.requestError="При загрузке товара произошла ошибка",this.isLoading=!1}))},openModal(){this.isModalOpen=!0},closeModal(t){if(!t)return this.isModalOpen=!1,void(this.isReceipt=!1);(t.target.classList.contains("fixed-overlay")||t.target.closest(".closeBtn"))&&(this.isModalOpen=!1,this.isReceipt=!1)},reportReceipt(){this.isReceipt=!0}},filters:{numberFormat:a.Z}},L=P,A=(0,p.Z)(L,r,o,!1,null,"6a9ed383",null),x=A.exports}}]);
//# sourceMappingURL=61.fb157a8e.js.map